<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:mpLayoutManager"
             x:Class="mpLayoutManager.LmPalette">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colors.xaml"/>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml"/>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml"/>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.AnimatedSingleRowTabControl.xaml"/>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/Blue.xaml"/>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseLight.xaml"/>
                <ResourceDictionary Source="pack://application:,,,/ModPlusAPI;component/Windows/WinResources/Styles.xaml"></ResourceDictionary>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Grid.Resources>
                <Canvas x:Key="appbar_settings" Width="76" Height="76" Clip="F1M0,0L76,0 76,76 0,76 0,0">
                    <Path Width="38.9239" Height="38.9239" Canvas.Left="18.538" Canvas.Top="18.5381" Stretch="Fill" Fill="#FF000000"
                                 Data="F1M38,23.5C38.8643,23.5,39.7109,23.5756,40.5337,23.7206L42.6275,18.5381 48.1901,20.787 46.0964,25.9692C47.6473,27.0149,48.9851,28.3527,50.0308,29.9036L55.213,27.8099 57.4619,33.3725 52.2794,35.4664C52.4244,36.2891 52.5,37.1357 52.5,38 52.5,38.8643 52.4244,39.7109 52.2794,40.5337L57.4619,42.6275 55.213,48.1901 50.0308,46.0964C49.0795,47.5073,47.8865,48.7418,46.5112,49.7405L48.7844,54.8462 43.3041,57.2891 41.0307,52.1828C40.0533,52.3906 39.0394,52.5 38,52.5 37.1357,52.5 36.2891,52.4244 35.4664,52.2794L33.3725,57.462 27.8099,55.213 29.9036,50.0309C28.3527,48.9851,27.0149,47.6473,25.9691,46.0964L20.787,48.1901 18.538,42.6275 23.7206,40.5336C23.5756,39.7109 23.5,38.8643 23.5,38 23.5,37.1357 23.5756,36.2891 23.7206,35.4664L18.538,33.3725 20.787,27.8099 25.9691,29.9036C26.9205,28.4927,28.1135,27.2582,29.4889,26.2594L27.2157,21.1537 32.6959,18.7109 34.9694,23.8172C35.9468,23.6094,36.9606,23.5,38,23.5z M38,28C32.4771,28 28,32.4772 28,38 28,43.5229 32.4771,48 38,48 43.5228,48 48,43.5229 48,38 48,32.4772 43.5228,28 38,28z"/>
                </Canvas>
                <Canvas x:Key="appbar_page_add"
                         Width="76"
                         Height="76"
                         Clip="F1M0,0L76,0 76,76 0,76 0,0">
                    <Path Width="36"
                                 Height="42"
                                 Canvas.Left="20"
                                 Canvas.Top="17"
                                 Stretch="Fill"
                                 Fill="#FF000000"
                                 Data="F1M43,30L50.75,30 43,22.25 43,30z M52,34L39,34 39,21 24,21 24,45 20,45 20,17 43.25,17 56,29.75 56,59 34,59 34,55 52,55 52,34z M28,38L33,38 33,46 41,46 41,51 33,51 33,59 28,59 28,51 20,51 20,46 28,46 28,38z M20,59L20,52 24,52 24,55 27,55 27,59 20,59z"/>
                </Canvas>
                <Canvas x:Key="appbar_page_solid_add"
                         Width="76"
                         Height="76"
                         Clip="F1M0,0L76,0 76,76 0,76 0,0">
                    <Path Width="35"
                                 Height="40"
                                 Canvas.Left="17"
                                 Canvas.Top="17"
                                 Stretch="Fill"
                                 Fill="#FF000000"
                                 Data="F1M17,28L17,23 23,23 23,17 28,17 28,23 34,23 34,28 28,28 28,34 23,34 23,28 17,28z M40,19L40,31 52,31 52,57 24,57 24,35 29,35 29,29 35,29 35,22 29,22 29,19 40,19z M41,30L41,19 52,30 41,30z"/>
                </Canvas>
            </Grid.Resources>
            <Button Name="BtAddLayuot" Grid.Column="0"
                     Margin="2" Padding="2"
                     ToolTip="Новый лист"
                     Click="BtAddLayuot_OnClick">
                <Rectangle Width="20" Height="20" Fill="#FF696969">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Uniform" Visual="{DynamicResource appbar_page_add}"/>
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
            <Button Name="BtAddLayuotByTemplate"
                     Grid.Column="1" Padding="2"
                     Margin="0,2,2,2"
                     ToolTip="Новый лист по шаблону"
                     Click="BtAddLayuotByTemplate_OnClick">
                <Rectangle Width="20" Height="20" Fill="#FF696969">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Uniform" Visual="{DynamicResource appbar_page_solid_add}"/>
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
            <Button Name="LmSettings" Grid.Column="3"
                     Margin="2" Padding="2"
                     Click="LmSettings_OnClick">
                <Rectangle Width="20" Height="20" Fill="#FF696969">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Uniform" Visual="{StaticResource appbar_settings}"/>
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
        </Grid>
        <ListView Name="LvLayouts" Margin="2,0,2,2" BorderThickness="1"
                 Grid.Row="1" SelectionMode="Extended" Padding="0"
                 SelectionChanged="LvLayouts_OnSelectionChanged">
            <ListView.Resources>
                <ContextMenu x:Key="ItemContextMenu" Opened="ItemContextMenu_OnOpened">
                    <MenuItem Name="MiOpen" Header="Открыть" Click="MenuItem_Open_OnClick"/>
                    <MenuItem Name="MiDelete" Header="Удалить" Click="MenuItem_Delete_OnClick"/>
                    <MenuItem Name="MiRename" Header="Переименовать" Click="MenuItem_Rename_OnClick"/>
                    <MenuItem Name="MiMoveCopy" Header="Переместить/копировать" Click="MiMoveCopy_OnClick"/>
                    <MenuItem Name="MiSelectAll" Header="Выбрать все листы" Click="MiSelectAll_OnClick"/>
                    <Separator/>
                    <MenuItem Name="MiPageSetup" Header="Диспетчер параметров листов" Click="MiPageSetup_OnClick"/>
                    <MenuItem Name="MiPlot" Header="Печать" Click="MiPlot_OnClick"/>
                    <Separator/>
                    <MenuItem Name="MiExportLayout" Header="Экспорт вкладки листа во вкладку модели" Click="MiExportLayout_OnClick"/>
                </ContextMenu>
            </ListView.Resources>
            <ListView.ItemTemplate>
                <DataTemplate>
                    <TextBlock VerticalAlignment="Center" Text="{Binding Path=LayoutName}"/>
                </DataTemplate>
            </ListView.ItemTemplate>
            <ListView.ItemContainerStyle>
                <Style  TargetType="{x:Type ListViewItem}">
                    <Setter Property="ContextMenu" Value="{StaticResource ItemContextMenu}"/>
                    <Setter Property="Margin" Value="1,1,1,0"/>
                    <EventSetter Event="MouseDoubleClick" Handler="LayoutItem_DoubleClick"></EventSetter>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=TabSelected}" Value="true">
                            <Setter Property="Control.Background" Value="#FFD3D3D3"/>
                            <Setter Property="Control.Foreground" Value="#FF8B0000"/>
                        </DataTrigger>
                        <Trigger Property="local:ListViewItemDragState.IsBeingDragged" Value="True">
                            <Setter Property="Control.FontWeight" Value="DemiBold"/>
                        </Trigger>
                        <Trigger Property="local:ListViewItemDragState.IsUnderDragCursor" Value="True">
                            <Setter Property="Control.Background" Value="#FF808080"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>
    </Grid>
</UserControl>